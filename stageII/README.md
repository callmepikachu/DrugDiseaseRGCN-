# Stage II: 药物-疾病-蛋白质三元关系预测

本阶段扩展原有的二元关系预测模型，实现药物-疾病-蛋白质的三元关系预测，探索药物作用的分子机制。

## 🎯 研究目标

1. **三元关系建模**: 同时考虑药物-疾病-蛋白质的复杂关系
2. **机制解释**: 通过蛋白质节点解释药物治疗疾病的分子机制
3. **关系预测**: 预测未知的药物-疾病-蛋白质关联

## 📊 数据扩展

### 新增实体类型
- **蛋白质**: 18,616个蛋白质节点
- **基因**: 29,532个基因节点
- **通路**: 2,526个生物通路

### 新增关系类型
- 药物-蛋白质相互作用
- 蛋白质-疾病关联
- 基因-蛋白质表达
- 蛋白质-通路参与

## 🏗️ 模型架构

### 三元关系预测模型
```
输入: (药物, 疾病) 节点对
输出: 
  1. 关系存在性 (二分类)
  2. 相关蛋白质排序 (排序学习)
  3. 作用通路预测 (多分类)
```

### 多任务学习框架
- **任务1**: 药物-疾病关系存在性预测
- **任务2**: 关键蛋白质识别
- **任务3**: 生物通路预测
- **任务4**: 作用机制分类

## 📁 文件结构

```
stageII/
├── README.md                    # 本文档
├── config.yaml                  # Stage II配置文件
├── data_analyzer.py             # 三元关系数据分析
├── triple_model.py              # 三元关系预测模型
├── triple_trainer.py            # 训练脚本
├── triple_evaluator.py          # 评估脚本
├── pathway_analyzer.py          # 通路分析工具
└── results/                     # 结果输出目录
    ├── models/                  # 模型检查点
    ├── predictions/             # 预测结果
    └── visualizations/          # 可视化结果
```

## 🚀 使用方法

### 1. 数据分析
```bash
cd stageII
python data_analyzer.py --analyze_triple_relations
```

### 2. 模型训练
```bash
python triple_trainer.py --config config.yaml
```

### 3. 结果评估
```bash
python triple_evaluator.py --model_path results/models/triple_model_best.pth
```

### 4. 通路分析
```bash
python pathway_analyzer.py --drug_id DRUG_001 --disease_id DISEASE_001
```

## 📈 预期结果

1. **三元关系预测准确率**: 目标 > 80%
2. **蛋白质排序性能**: 目标 MAP@10 > 0.7
3. **通路预测准确率**: 目标 > 75%
4. **机制解释能力**: 提供可解释的药物作用机制

## 🔬 研究意义

- **精准医学**: 为个性化治疗提供分子层面的指导
- **药物重定位**: 发现现有药物的新适应症
- **副作用预测**: 通过蛋白质相互作用预测潜在副作用
- **机制理解**: 深入理解药物作用的分子机制
